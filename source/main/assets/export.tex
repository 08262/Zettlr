% Barebone template for use with Zettlr exporting engine

% We have to use KOMA classes (scrartcl instead of article and scrreprt instead of report as well as scrbook instead of book)
% More info: https://ctan.org/pkg/koma-script?lang=de
\documentclass[%FONT_SIZE%]{scrartcl}

% The following packages are needed for the combined use of Pandoc and XeTeX engine
\usepackage{fontspec,xltxtra,xunicode}
\usepackage[english]{babel}

% Captions for tables and images
\usepackage{caption}
\captionsetup{format=plain, font=small, labelfont=bf}

% This package is needed for better rendering of images (including captions)
\usepackage{graphicx}

% Calc is needed to compute the image width (to prevent up-scaling of small images)
\usepackage{calc}

% Pandoc uses includegraphics. But as some images may be too big, we have to
% replace the command with another one that ensures proper scaling of images.
% Therefore first save the old includegraphics command somewhere else.
\let\oldincg\includegraphics

% Create the imgwidth variable
\newlength{\imgwidth}

% Now renew the original includegraphics command to include some logic that
% first determines the width of the image and then either scales it down or
% retains it at original size (using the minof command). The centering is done
% automatically by Pandoc.
\renewcommand\includegraphics[1]{%
    \settowidth{\imgwidth}{\oldincg{#1}}%
    \setlength{\imgwidth}{\minof{\imgwidth}{\textwidth}}%
    \oldincg[width=\imgwidth]{#1}%
}

% Now we also have to make sure that the figures Pandoc inserts are positioned
% approximately where they are at. Therefore we have to overwrite the
% \begin{figure} command a little bit by using the float package:
\usepackage{float}
\floatplacement{figure}{H} % ensure default position as H (exactly where the figure is in the text)

% Needed for pandoc's table generation
\usepackage{longtable}
\usepackage{booktabs}  % For using \midrule and \toprule, whatever they are

% Optional packages that Zettlr makes use of
% fontspec is used to set the different fonts to the user's whishes
\usepackage{fontspec}
\setmainfont{%MAIN_FONT%}

% With geometry we can let the user decide on the margin
\usepackage{geometry}
% Additional options for geometry can be found here: http://texdoc.net/texmf-dist/doc/latex/geometry/geometry.pdf
\geometry{verbose,letterpaper,tmargin=%TOP_MARGIN%,bmargin=%BOTTOM_MARGIN%,lmargin=%LEFT_MARGIN%,rmargin=%RIGHT_MARGIN%}

% PAGE NUMBERING OPTIONS: https://de.sharelatex.com/learn/Page_numbering
\pagenumbering{%PAGE_NUMBERING%}

% Line spacing
\usepackage{setspace}

% Can be a multiple of 1 (i.e. 1.5 for 150 percent)
\setstretch{%LINE_SPACING%}

% PDF metadata generated by Zettlr or given by the user, also some other URL
% options (breaklinks breaks URLs so they aren't ugly)
\usepackage[unicode=true, breaklinks=true]{hyperref}
\hypersetup{
pdftitle={%PDF_TITLE%},
pdfsubject={%PDF_SUBJECT%},
pdfauthor={%PDF_AUTHOR%},
pdfkeywords={%PDF_KEYWORDS%},
pdfproducer={Zettlr with Pandoc and XeLaTeX}
}

% Always use today's date TODO: Nope, let the user decide (for projects)
\date{\today}

% The following commands must be provided for Pandoc to work correctly.
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

\title{%PDF_TITLE%}
\author{%PDF_AUTHOR%}

\begin{document}

% Title page?
%TITLEPAGE%

% Generate a table of contents?
%GENERATE_TOC%

% LIST OF TABLES?
$if(lot)$
\listoftables
$endif$

% LIST OF FIGURES?
$if(lof)$
\listoffigures
$endif$

% BEGIN BODY
$body$

\end{document}
